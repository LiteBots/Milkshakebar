<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#ff6a00" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>Milk — Aplikacja</title>

  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#0b0b10;
      --bg1:#0f0f18;
      --card:rgba(255,255,255,.08);
      --card2:rgba(255,255,255,.10);
      --stroke:rgba(255,255,255,.14);
      --text:#f6f6fb;
      --muted:rgba(255,255,255,.72);
      --muted2:rgba(255,255,255,.58);
      --accent:#ff6a00;
      --accent2:#ff9100;
      --good:#28d17c;
      --warn:#ffcf5a;
      --bad:#ff4b4b;

      --r:22px;
      --r2:28px;
      --shadow:0 18px 55px rgba(0,0,0,.42);

      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(255,106,0,.22), transparent 60%),
        radial-gradient(900px 700px at 90% 0%, rgba(255,145,0,.18), transparent 58%),
        radial-gradient(1100px 900px at 50% 110%, rgba(255,106,0,.12), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* blobs */
    .blob{
      position:fixed;
      inset:auto;
      width:520px;height:520px;
      border-radius:999px;
      filter: blur(50px);
      opacity:.26;
      z-index:0;
      pointer-events:none;
      background: radial-gradient(circle at 30% 30%, rgba(255,145,0,.95), rgba(255,106,0,.10) 60%, transparent 70%);
      animation: floaty 11s ease-in-out infinite;
    }
    .blob.b1{left:-180px;top:20px}
    .blob.b2{right:-220px;top:180px;opacity:.22;animation-duration:14s}
    .blob.b3{left:20%;bottom:-260px;opacity:.18;animation-duration:16s}
    @keyframes floaty{
      0%,100%{transform: translate3d(0,0,0) scale(1)}
      50%{transform: translate3d(0,-14px,0) scale(1.03)}
    }

    /* layout */
    .app{
      position:relative;
      z-index:1;
      min-height:100%;
      display:flex;
      flex-direction:column;
      padding-bottom: calc(86px + var(--safe-bottom));
    }

    .topbar{
      position:sticky;
      top:0;
      z-index:50;
      padding: calc(14px + var(--safe-top)) 14px 12px;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      background: linear-gradient(180deg, rgba(15,15,24,.72), rgba(15,15,24,.40));
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .topbar-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      max-width:1100px;
      margin:0 auto;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .logo{
      width:38px;height:38px;border-radius:14px;
      background: radial-gradient(circle at 30% 30%, var(--accent2), var(--accent));
      box-shadow:0 12px 35px rgba(255,106,0,.25);
      border:1px solid rgba(255,255,255,.14);
      flex:0 0 auto;
    }
    .brand .t{
      display:flex;
      flex-direction:column;
      line-height:1.05;
      min-width:0;
    }
    .brand .t b{
      font-size:15px;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand .t span{
      font-size:12px;
      color:var(--muted2);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:9px 12px;
      border-radius:999px;
      background: linear-gradient(180deg, rgba(255,255,255,.11), rgba(255,255,255,.07));
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 12px 40px rgba(0,0,0,.25);
      white-space:nowrap;
      flex:0 0 auto;
    }
    .pill .dot{
      width:10px;height:10px;border-radius:99px;
      background: radial-gradient(circle at 30% 30%, var(--accent2), var(--accent));
      box-shadow:0 0 0 4px rgba(255,106,0,.14);
    }
    .pill .v{
      font-weight:700;
      font-size:13px;
    }
    .pill .lbl{
      font-size:12px;color:var(--muted2);font-weight:600;
    }

    .container{
      width:100%;
      max-width:1100px;
      margin:0 auto;
      padding:14px;
    }

    /* cards */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.11), rgba(255,255,255,.07));
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card-inner{padding:14px}
    .card-title{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin:0 0 10px;
    }
    .card-title h2{
      margin:0;
      font-size:15px;
      letter-spacing:.2px;
    }
    .sub{
      color:var(--muted2);
      font-size:12px;
      margin:2px 0 0;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
    @media (min-width: 860px){
      .grid.two{grid-template-columns: 1.2fr .8fr}
      .grid.three{grid-template-columns: 1fr 1fr 1fr}
    }

    /* buttons */
    .btn{
      appearance:none;
      border:0;
      cursor:pointer;
      font-family:inherit;
      color:var(--text);
      font-weight:700;
      border-radius: 16px;
      padding:12px 14px;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.08));
      border:1px solid rgba(255,255,255,.16);
      transition: transform .08s ease, filter .12s ease, background .2s ease;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      user-select:none;
    }
    .btn:active{transform:scale(.98)}
    .btn.primary{
      background: linear-gradient(135deg, var(--accent2), var(--accent));
      border:1px solid rgba(255,255,255,.18);
      box-shadow:0 14px 35px rgba(255,106,0,.25);
    }
    .btn.ghost{
      background: transparent;
      border:1px solid rgba(255,255,255,.14);
    }
    .btn.small{padding:10px 12px;border-radius:14px;font-size:12px}
    .btn.full{width:100%}

    /* inputs */
    .field{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin:10px 0;
    }
    .field label{
      font-size:12px;
      color:var(--muted2);
      font-weight:600;
    }
    .input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(10,10,14,.35);
      color:var(--text);
      outline:none;
      font-family:inherit;
    }
    textarea{min-height:92px;resize:vertical}
    .row{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    @media (min-width: 560px){
      .row.two{grid-template-columns: 1fr 1fr}
      .row.three{grid-template-columns: 1fr 1fr 1fr}
    }

    /* tabs/pages */
    .page{display:none}
    .page.active{display:block;animation:fadeIn .18s ease}
    @keyframes fadeIn{from{opacity:.4;transform:translateY(4px)}to{opacity:1;transform:none}}

    /* bottom nav */
    .bottom-nav{
      position:fixed;
      left:0; right:0;
      bottom:0;
      z-index:60;
      padding:10px 12px calc(10px + var(--safe-bottom));
      background: linear-gradient(180deg, rgba(10,10,14,.20), rgba(10,10,14,.78));
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      border-top:1px solid rgba(255,255,255,.10);
    }
    .nav-inner{
      max-width:1100px;
      margin:0 auto;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap:8px;
    }
    .nav-btn{
      border:0;
      background: transparent;
      color: var(--muted2);
      font-family:inherit;
      cursor:pointer;
      border-radius: 18px;
      padding:10px 8px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:6px;
      transition: background .15s ease, color .15s ease, transform .08s ease;
      user-select:none;
    }
    .nav-btn:active{transform:scale(.98)}
    .nav-btn.active{
      color: var(--text);
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
    }
    .nav-ico{
      width:22px;height:22px;border-radius:8px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
    }
    .nav-lbl{font-size:11px;font-weight:700}

    /* misc */
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
      color: var(--muted);
      font-size:12px;
      font-weight:700;
    }
    .badge .b-dot{
      width:9px;height:9px;border-radius:99px;
      background: var(--good);
      box-shadow: 0 0 0 4px rgba(40,209,124,.12);
    }
    .badge.warn .b-dot{background:var(--warn);box-shadow:0 0 0 4px rgba(255,207,90,.14)}
    .badge.bad .b-dot{background:var(--bad);box-shadow:0 0 0 4px rgba(255,75,75,.14)}

    .hr{
      height:1px;
      background: rgba(255,255,255,.10);
      margin:12px 0;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .item{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      padding:12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
    }
    .item .meta{min-width:0}
    .item .meta b{
      display:block;
      font-size:13px;
      line-height:1.15;
      margin-bottom:2px;
    }
    .item .meta span{
      display:block;
      font-size:12px;
      color:var(--muted2);
    }
    .item .right{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:8px;
      flex:0 0 auto;
    }
    .price{
      font-weight:800;
      letter-spacing:.2px;
      font-size:13px;
      white-space:nowrap;
    }

    /* chips/categories */
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      padding:2px 0 6px;
    }
    .chip{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
      color: var(--muted);
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
      font-family:inherit;
      font-weight:800;
      font-size:12px;
      transition: background .15s ease, transform .08s ease, color .15s ease;
      user-select:none;
    }
    .chip:active{transform:scale(.98)}
    .chip.active{
      color: var(--text);
      background: rgba(255,106,0,.18);
      border-color: rgba(255,106,0,.35);
    }

    /* cart FAB */
    .cart-fab{
      position:fixed;
      right:14px;
      bottom: calc(96px + var(--safe-bottom));
      z-index:70;
      width:min(420px, calc(100% - 28px));
      display:none;
    }
    .cart-fab .btn{
      width:100%;
      border-radius: 20px;
      padding:14px 14px;
      justify-content:space-between;
    }
    .cart-fab .sum{
      display:flex;flex-direction:column;align-items:flex-start;gap:2px;
      font-size:12px;font-weight:800;
    }
    .cart-fab .sum span{color:rgba(255,255,255,.78);font-weight:700;font-size:11px}
    @media (min-width: 860px){
      .cart-fab{right:22px;bottom: calc(100px + var(--safe-bottom));width: 360px;}
    }

    /* modals */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:flex-end;
      justify-content:center;
      z-index:90;
      background: rgba(0,0,0,.55);
      padding: 14px 14px calc(14px + var(--safe-bottom));
    }
    .modal.show{display:flex}
    .sheet{
      width: min(720px, 100%);
      border-radius: 26px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(20,20,30,.92), rgba(12,12,18,.92));
      box-shadow: 0 26px 90px rgba(0,0,0,.55);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }
    .sheet-h{
      padding:12px 14px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .sheet-h b{font-size:13px}
    .sheet-b{padding:14px}
    .x{
      width:40px;height:40px;border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--text);
      cursor:pointer;
      font-weight:900;
    }

    /* toast */
    .toasts{
      position:fixed;
      left:0; right:0;
      top: calc(10px + var(--safe-top));
      z-index:120;
      pointer-events:none;
      display:flex;
      justify-content:center;
      padding: 0 14px;
    }
    .toast{
      pointer-events:auto;
      width:min(560px,100%);
      background: rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.14);
      border-radius: 18px;
      padding:12px 14px;
      box-shadow: 0 18px 55px rgba(0,0,0,.45);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      display:none;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .toast.show{display:flex;animation:toastIn .18s ease}
    @keyframes toastIn{from{opacity:.3;transform:translateY(-6px)}to{opacity:1;transform:none}}
    .toast b{font-size:12px}
    .toast span{display:block;color:var(--muted2);font-size:12px;margin-top:2px}
    .toast .tclose{
      pointer-events:auto;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      border-radius: 12px;
      padding:8px 10px;
      font-weight:900;
      color:var(--text);
      cursor:pointer;
    }

    /* install overlay */
    .install{
      position:fixed;
      inset:0;
      z-index:200;
      display:none;
      background: rgba(0,0,0,.66);
      padding: 14px 14px calc(14px + var(--safe-bottom));
      align-items:flex-end;
      justify-content:center;
    }
    .install.show{display:flex}
    .install .sheet{max-width:760px}
    .steps{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:10px;
    }
    .step{
      display:flex;
      gap:10px;
      padding:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
    }
    .step .n{
      width:28px;height:28px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      background: rgba(255,106,0,.18);
      border:1px solid rgba(255,106,0,.28);
      font-weight:900;
      flex:0 0 auto;
    }
    .step b{font-size:12px}
    .step span{display:block;color:var(--muted2);font-size:12px;margin-top:2px}

    /* tables inside cards */
    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .kpi .k{
      padding:12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
    }
    .k .l{font-size:11px;color:var(--muted2);font-weight:700}
    .k .v{font-size:16px;font-weight:900;margin-top:2px}

    .mini{
      font-size:12px;
      color:var(--muted2);
      line-height:1.35;
    }

    /* helper */
    .hide{display:none !important}
  </style>
</head>

<body>
  <div class="blob b1"></div>
  <div class="blob b2"></div>
  <div class="blob b3"></div>

  <!-- TOASTS -->
  <div class="toasts">
    <div class="toast" id="toast">
      <div>
        <b id="toastTitle">Info</b>
        <span id="toastMsg">…</span>
      </div>
      <button class="tclose" id="toastClose">OK</button>
    </div>
  </div>

  <!-- INSTALL OVERLAY -->
  <div class="install" id="installOverlay" aria-hidden="true">
    <div class="sheet">
      <div class="sheet-h">
        <b>Dodaj Milk do ekranu głównego</b>
        <button class="x" id="installClose" aria-label="Zamknij">✕</button>
      </div>
      <div class="sheet-b">
        <div class="mini">
          Dzięki instalacji aplikacja działa szybciej i jak „prawdziwa” apka.
        </div>

        <div class="steps" id="installSteps">
          <div class="step">
            <div class="n">1</div>
            <div>
              <b>Android (Chrome)</b>
              <span>Kliknij „Zainstaluj” lub menu ⋮ → „Dodaj do ekranu głównego”.</span>
            </div>
          </div>
          <div class="step">
            <div class="n">2</div>
            <div>
              <b>iPhone (Safari)</b>
              <span>Udostępnij ⤴ → „Dodaj do ekranu początkowego”.</span>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="row two">
          <button class="btn primary full" id="installBtn">Zainstaluj (Android)</button>
          <button class="btn ghost full" id="installLater">Później</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MILK ID MODAL -->
  <div class="modal" id="milkIdModal" aria-hidden="true">
    <div class="sheet">
      <div class="sheet-h">
        <b>Milk ID</b>
        <button class="x" id="milkIdClose" aria-label="Zamknij">✕</button>
      </div>
      <div class="sheet-b">
        <div class="mini">Twój kod lojalnościowy (6 cyfr). Pokaż go przy kasie.</div>
        <div class="hr"></div>
        <div class="row two">
          <div class="field" style="margin:0">
            <label>Kod</label>
            <input class="input" id="milkIdInput" value="••••••" readonly>
          </div>
          <div class="field" style="margin:0">
            <label>&nbsp;</label>
            <button class="btn primary full" id="milkIdCopy">Kopiuj</button>
          </div>
        </div>
        <div class="mini" id="milkIdHint" style="margin-top:10px"></div>
      </div>
    </div>
  </div>

  <!-- CART MODAL -->
  <div class="modal" id="cartModal" aria-hidden="true">
    <div class="sheet">
      <div class="sheet-h">
        <b>Koszyk — Zamów i odbierz</b>
        <button class="x" id="cartClose" aria-label="Zamknij">✕</button>
      </div>
      <div class="sheet-b">
        <div class="list" id="cartList">
          <!-- items injected by script -->
        </div>

        <div class="hr"></div>

        <div class="row two">
          <div class="field" style="margin:0">
            <label>Imię i nazwisko</label>
            <input class="input" id="checkoutName" placeholder="np. Jan Kowalski">
          </div>
          <div class="field" style="margin:0">
            <label>Telefon</label>
            <input class="input" id="checkoutPhone" placeholder="np. 500 000 000" inputmode="tel">
          </div>
        </div>

        <div class="row three">
          <div class="field" style="margin:0">
            <label>Odbiór (lokal)</label>
            <select id="checkoutLocation">
              <option value="Słupsk">Słupsk</option>
              <option value="Rowy" disabled>Rowy (wyłączone)</option>
            </select>
          </div>
          <div class="field" style="margin:0">
            <label>Godzina odbioru</label>
            <input class="input" id="checkoutTime" type="time">
          </div>
          <div class="field" style="margin:0">
            <label>Uwagi</label>
            <input class="input" id="checkoutNotes" placeholder="opcjonalnie">
          </div>
        </div>

        <div class="hr"></div>

        <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
          <div class="badge" id="cartTotalBadge"><span class="b-dot"></span> Suma: <span id="cartTotal">0</span> PLN</div>
          <button class="btn primary" id="placeOrderBtn">Złóż zamówienie</button>
        </div>

        <div class="mini" id="pickupRuleHint" style="margin-top:10px"></div>
      </div>
    </div>
  </div>

  <div class="app">
    <header class="topbar">
      <div class="topbar-row">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div class="t">
            <b>Milk</b>
            <span id="topSubtitle">Lojalność • Nagrody • Zamówienia</span>
          </div>
        </div>
        <div class="pill" id="pointsPill" title="Twoje punkty">
          <div class="dot" aria-hidden="true"></div>
          <div class="v"><span id="pointsValue">0</span> <span class="lbl">pkt</span></div>
        </div>
      </div>
    </header>

    <main class="container">
      <!-- OPENING HOURS / STATUS -->
      <section class="card" id="statusCard">
        <div class="card-inner">
          <div class="card-title">
            <div>
              <h2>Status lokalu</h2>
              <div class="sub" id="statusSub">Sprawdź, czy jesteśmy otwarci</div>
            </div>
            <div class="badge" id="statusBadge">
              <span class="b-dot"></span>
              <span id="statusText">Otwarte</span>
            </div>
          </div>

          <div class="mini" id="hoursMini">
            Godziny otwarcia: <b>pokaż/ukryj</b> klikając w ten kafelek.
          </div>

          <div class="hr"></div>

          <div class="kpi" id="hoursGrid">
            <div class="k"><div class="l">Pon–Czw</div><div class="v" id="h1">—</div></div>
            <div class="k"><div class="l">Pią</div><div class="v" id="h2">—</div></div>
            <div class="k"><div class="l">Sob</div><div class="v" id="h3">—</div></div>
            <div class="k"><div class="l">Nie</div><div class="v" id="h4">—</div></div>
          </div>
        </div>
      </section>

      <div style="height:12px"></div>

      <!-- QUICK ACTIONS -->
      <section class="grid two">
        <div class="card">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>Szybkie akcje</h2>
                <div class="sub">Najważniejsze funkcje pod ręką</div>
              </div>
            </div>

            <div class="row two">
              <button class="btn primary" id="qaMilkId">Pokaż Milk ID</button>
              <button class="btn" id="qaOrder">Zamów i odbierz</button>
            </div>

            <div class="row two">
              <button class="btn" id="qaRewards">Nagrody</button>
              <button class="btn" id="qaReservation">Rezerwacje</button>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>Eatmi</h2>
                <div class="sub">Szybkie zamawianie online</div>
              </div>
            </div>
            <div class="mini">
              Wkrótce więcej integracji — na ten moment promocja/odnośnik.
            </div>
            <div class="hr"></div>
            <button class="btn primary full" id="eatmiBtn">Przejdź do eatmi.pl</button>
          </div>
        </div>
      </section>

      <div style="height:12px"></div>

      <!-- PAGES -->
      <section class="page active" id="pagePoints">
        <div class="grid two">
          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Punkty</h2>
                  <div class="sub">Zbieraj punkty i odbieraj nagrody</div>
                </div>
                <button class="btn small ghost" id="openMilkId">Milk ID</button>
              </div>

              <div class="kpi">
                <div class="k"><div class="l">Twoje punkty</div><div class="v"><span id="pointsBig">0</span> pkt</div></div>
                <div class="k"><div class="l">Do najbliższej nagrody</div><div class="v" id="toNext">—</div></div>
              </div>

              <div class="hr"></div>

              <div class="mini" id="pointsInfo">
                Punkty naliczane są przez obsługę. W aplikacji widzisz stan konta i historię.
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Historia punktów</h2>
                  <div class="sub">Ostatnie operacje</div>
                </div>
              </div>

              <div class="list" id="pointsHistory">
                <!-- injected by script -->
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="page" id="pageRewards">
        <div class="card">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>Nagrody</h2>
                <div class="sub">Wybierz nagrodę i zrealizuj za punkty</div>
              </div>
            </div>

            <!-- UWAGA: lista jest renderowana przez SCRIPT (część 2),
                 ale tu usunięte są stare nagrody w HTML i zostawiona jest tylko sekcja listy. -->
            <div class="list" id="rewardsList">
              <!-- injected by script: 3 nowe nagrody -->
            </div>

            <div class="hr"></div>
            <div class="mini">
              Jeśli nie masz wystarczającej liczby punktów, przycisk realizacji będzie nieaktywny.
            </div>
          </div>
        </div>
      </section>

      <section class="page" id="pageOrder">
        <div class="grid two">
          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Zamów i odbierz</h2>
                  <div class="sub">Wybierz kategorię i dodaj produkty do koszyka</div>
                </div>
                <button class="btn small ghost" id="openCartTop">Koszyk</button>
              </div>

              <div class="chips" id="orderCategories">
                <!-- injected by script: chips z kategorii -->
              </div>

              <div class="hr"></div>

              <div class="list" id="orderProducts">
                <!-- injected by script: produkty z wbudowanego menu (bez menu.json) -->
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Twoje zamówienia</h2>
                  <div class="sub">Historia “Zamów i odbierz”</div>
                </div>
              </div>

              <div class="list" id="ordersList">
                <!-- injected by script -->
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="page" id="pageReservations">
        <div class="grid two">
          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Rezerwacja</h2>
                  <div class="sub">Szybko zarezerwuj stolik</div>
                </div>
              </div>

              <div class="row two">
                <div class="field" style="margin:0">
                  <label>Imię</label>
                  <input class="input" id="resName" placeholder="np. Klaudia">
                </div>
                <div class="field" style="margin:0">
                  <label>Telefon</label>
                  <input class="input" id="resPhone" placeholder="np. 500 000 000" inputmode="tel">
                </div>
              </div>

              <div class="row three">
                <div class="field" style="margin:0">
                  <label>Data</label>
                  <input class="input" id="resDate" type="date">
                </div>
                <div class="field" style="margin:0">
                  <label>Godzina</label>
                  <input class="input" id="resTime" type="time">
                </div>
                <div class="field" style="margin:0">
                  <label>Ilość osób</label>
                  <select id="resPeople">
                    <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option>
                    <option>7</option><option>8</option><option>9</option><option>10</option>
                  </select>
                </div>
              </div>

              <div class="field" style="margin:10px 0 0">
                <label>Uwagi (opcjonalnie)</label>
                <textarea id="resNotes" placeholder="np. urodziny, miejsce przy oknie…"></textarea>
              </div>

              <div class="hr"></div>

              <button class="btn primary full" id="resSend">Wyślij rezerwację</button>
              <div class="mini" id="resHint" style="margin-top:10px"></div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Moje rezerwacje</h2>
                  <div class="sub">Lista wysłanych rezerwacji</div>
                </div>
              </div>

              <div class="list" id="resList">
                <!-- injected by script -->
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="page" id="pageAccount">
        <div class="grid two">
          <div class="card" id="authCard">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Konto</h2>
                  <div class="sub" id="authSub">Zaloguj się, aby korzystać z pełnych funkcji</div>
                </div>
              </div>

              <div class="row two">
                <button class="btn primary full" id="loginGoogle">Zaloguj “Google”</button>
                <button class="btn full" id="loginEmail">Zaloguj e-mail</button>
              </div>

              <div class="hr"></div>

              <div class="field" style="margin:0">
                <label>E-mail</label>
                <input class="input" id="emailInput" placeholder="np. zexq2001@gmail.com" inputmode="email">
              </div>
              <div class="field" style="margin:0">
                <label>Hasło (mock)</label>
                <input class="input" id="passInput" type="password" placeholder="••••••••">
              </div>

              <div class="row two">
                <button class="btn primary full" id="loginSubmit">Zaloguj</button>
                <button class="btn ghost full" id="logoutBtn">Wyloguj</button>
              </div>

              <div class="mini" id="authHint" style="margin-top:10px"></div>
            </div>
          </div>

          <div class="card">
            <div class="card-inner">
              <div class="card-title">
                <div>
                  <h2>Ustawienia</h2>
                  <div class="sub">Profil, język, informacje</div>
                </div>
              </div>

              <div class="row two">
                <button class="btn full" id="settingsPersonal">Dane</button>
                <button class="btn full" id="settingsLang">Język</button>
              </div>
              <div class="row two">
                <button class="btn full" id="settingsAbout">O aplikacji</button>
                <button class="btn full" id="settingsHelp">Pomoc</button>
              </div>

              <!-- USUNIĘTO: przycisk "odśwież dane z serwera" (zgodnie z Twoją instrukcją) -->

              <div class="hr"></div>
              <div class="mini">
                Wersja: <b id="appVer">1.0</b> • PWA: <b id="pwaState">—</b>
              </div>
            </div>
          </div>
        </div>

        <!-- subpages (ukrywane/pokazywane przez script) -->
        <div style="height:12px"></div>
        <div class="card hide" id="subPersonal">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>Dane</h2>
                <div class="sub">Zapis lokalny (profil)</div>
              </div>
              <button class="btn small ghost" id="subBack1">Wróć</button>
            </div>

            <div class="row two">
              <div class="field" style="margin:0">
                <label>Imię</label>
                <input class="input" id="profName">
              </div>
              <div class="field" style="margin:0">
                <label>Telefon</label>
                <input class="input" id="profPhone" inputmode="tel">
              </div>
            </div>

            <div class="hr"></div>
            <button class="btn primary full" id="profSave">Zapisz</button>
          </div>
        </div>

        <div class="card hide" id="subLang">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>Język</h2>
                <div class="sub">PL / EN</div>
              </div>
              <button class="btn small ghost" id="subBack2">Wróć</button>
            </div>

            <div class="row two">
              <button class="btn full" id="langPL">Polski</button>
              <button class="btn full" id="langEN">English</button>
            </div>
          </div>
        </div>

        <div class="card hide" id="subAbout">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>O aplikacji</h2>
                <div class="sub">Milk — PWA</div>
              </div>
              <button class="btn small ghost" id="subBack3">Wróć</button>
            </div>
            <div class="mini">
              Aplikacja lojalnościowa MilkShake Bar: punkty, nagrody, zamówienia i rezerwacje.
            </div>
          </div>
        </div>

        <div class="card hide" id="subHelp">
          <div class="card-inner">
            <div class="card-title">
              <div>
                <h2>Pomoc</h2>
                <div class="sub">Najczęstsze pytania</div>
              </div>
              <button class="btn small ghost" id="subBack4">Wróć</button>
            </div>
            <div class="mini">
              Jeśli coś nie działa, wyloguj i zaloguj się ponownie lub zainstaluj aplikację jako PWA.
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- CART FAB -->
    <div class="cart-fab" id="cartFab">
      <button class="btn primary" id="openCartFab">
        <div class="sum">
          <div>Koszyk: <span id="fabCount">0</span> szt.</div>
          <span>Suma: <span id="fabTotal">0</span> PLN</span>
        </div>
        <div style="font-weight:900">Otwórz</div>
      </button>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav" aria-label="Nawigacja">
      <div class="nav-inner">
        <button class="nav-btn active" data-tab="points" id="tabPoints">
          <div class="nav-ico" aria-hidden="true"></div>
          <div class="nav-lbl">Punkty</div>
        </button>
        <button class="nav-btn" data-tab="rewards" id="tabRewards">
          <div class="nav-ico" aria-hidden="true"></div>
          <div class="nav-lbl">Nagrody</div>
        </button>
        <button class="nav-btn" data-tab="order" id="tabOrder">
          <div class="nav-ico" aria-hidden="true"></div>
          <div class="nav-lbl">Zamów</div>
        </button>
        <button class="nav-btn" data-tab="reservations" id="tabReservations">
          <div class="nav-ico" aria-hidden="true"></div>
          <div class="nav-lbl">Rezerw.</div>
        </button>
        <button class="nav-btn" data-tab="account" id="tabAccount">
          <div class="nav-ico" aria-hidden="true"></div>
          <div class="nav-lbl">Konto</div>
        </button>
      </div>
    </nav>

    <script>
      <script>
/* =========================
   MILK PWA — SCRIPT (CZĘŚĆ 2)
   Zmiany:
   ✅ Menu wbudowane w kod (bez menu.json)
   ✅ Nowe nagrody (3 pozycje) + usunięte stare
   ✅ Usunięta funkcja/przycisk “odśwież dane z serwera” (nie ma go w HTML, i nie ma logiki w JS)
   ========================= */

(() => {
  "use strict";

  /* -------------------------
     Wbudowane MENU (zamiast menu.json)
     ------------------------- */
  const MENU_CATALOG = {
    "schemaVersion": "1.0",
    "currency": "PLN",
    "items": [
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Espresso", "tag": "espresso", "desc": "35 ml", "price": 11 },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Podwójne espresso", "tag": "espresso", "desc": "70 ml", "price": 16 },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Affogato (espresso z lodami)", "tag": "deser kawowy", "desc": "", "price": "22/27",
        "variants": [
          { "label": "wariant 1", "price": 22, "size": null },
          { "label": "wariant 2", "price": 27, "size": null }
        ]
      },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Kawa czarna", "tag": "klasyka", "desc": "200/300 ml", "price": "12/17",
        "variants": [
          { "label": "200", "price": 12, "size": "200" },
          { "label": "300 ml", "price": 17, "size": "300 ml" }
        ]
      },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Kawa biała", "tag": "klasyka", "desc": "200/300 ml", "price": "12/17",
        "variants": [
          { "label": "200", "price": 12, "size": "200" },
          { "label": "300 ml", "price": 17, "size": "300 ml" }
        ]
      },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Cappuccino", "tag": "klasyka", "desc": "200/300 ml", "price": "13/18",
        "variants": [
          { "label": "200", "price": 13, "size": "200" },
          { "label": "300 ml", "price": 18, "size": "300 ml" }
        ]
      },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Latte", "tag": "klasyka", "desc": "200/300 ml", "price": "13/18",
        "variants": [
          { "label": "200", "price": 13, "size": "200" },
          { "label": "300 ml", "price": 18, "size": "300 ml" }
        ]
      },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Kawa mrożona", "tag": "na zimno", "desc": "300 ml", "price": 26 },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Frappe słony karmel", "tag": "na zimno", "desc": "Podwójne espresso, kostki lodu, mleko, słony karmel", "price": 27 },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Gorąca czekolada", "tag": "na ciepło", "desc": "200 ml", "price": 21 },
      { "category": "kawa-herbata", "categoryLabel": "Kawa", "title": "Dodatkowe espresso", "tag": "dodatek", "desc": "", "price": 5 },

      { "category": "kawa-herbata", "categoryLabel": "Herbata", "title": "Zielona", "tag": "klasyka", "desc": "", "price": 15 },
      { "category": "kawa-herbata", "categoryLabel": "Herbata", "title": "English breakfast", "tag": "klasyka", "desc": "", "price": 15 },
      { "category": "kawa-herbata", "categoryLabel": "Herbata", "title": "Piekielna herbata", "tag": "rozgrzewająca", "desc": "", "price": 22 },
      { "category": "kawa-herbata", "categoryLabel": "Herbata", "title": "Czort", "tag": "rozgrzewająca", "desc": "", "price": 22 },
      { "category": "kawa-herbata", "categoryLabel": "Herbata", "title": "Mon Cheri", "tag": "rozgrzewająca", "desc": "", "price": 22 },
      { "category": "kawa-herbata", "categoryLabel": "Herbata", "title": "Domowa herbata mrożona", "tag": "na zimno", "desc": "500 ml", "price": 26 },

      { "category": "kawa-herbata", "categoryLabel": "Matcha", "title": "Matcha latte", "tag": "matcha", "desc": "", "price": 20 },
      { "category": "kawa-herbata", "categoryLabel": "Matcha", "title": "Iced matcha", "tag": "matcha", "desc": "", "price": 25 },

      { "category": "napoje-soki", "categoryLabel": "Lemoniada", "title": "Cytrusowa", "tag": "lemoniada", "desc": "400/1200 ml", "price": "15/30",
        "variants": [
          { "label": "400", "price": 15, "size": "400" },
          { "label": "1200 ml", "price": 30, "size": "1200 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Lemoniada", "title": "Arbuzowa", "tag": "lemoniada", "desc": "400/1200 ml", "price": "17/35",
        "variants": [
          { "label": "400", "price": 17, "size": "400" },
          { "label": "1200 ml", "price": 35, "size": "1200 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Lemoniada", "title": "Ananasowa", "tag": "lemoniada", "desc": "400/1200 ml", "price": "17/35",
        "variants": [
          { "label": "400", "price": 17, "size": "400" },
          { "label": "1200 ml", "price": 35, "size": "1200 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Lemoniada", "title": "Gruszkowa", "tag": "lemoniada", "desc": "400/1200 ml", "price": "17/35",
        "variants": [
          { "label": "400", "price": 17, "size": "400" },
          { "label": "1200 ml", "price": 35, "size": "1200 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Lemoniada", "title": "Malinowa zimna", "tag": "lemoniada", "desc": "400/1200 ml", "price": "17/35",
        "variants": [
          { "label": "400", "price": 17, "size": "400" },
          { "label": "1200 ml", "price": 35, "size": "1200 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Lemoniada", "title": "Malinowa ciepła", "tag": "lemoniada", "desc": "400/1200 ml", "price": "17/35",
        "variants": [
          { "label": "400", "price": 17, "size": "400" },
          { "label": "1200 ml", "price": 35, "size": "1200 ml" }
        ]
      },

      { "category": "napoje-soki", "categoryLabel": "Napoje", "title": "Woda z kranu", "tag": "", "desc": "", "price": 0 },
      { "category": "napoje-soki", "categoryLabel": "Napoje", "title": "Woda niegazowana", "tag": "", "desc": "500 ml", "price": 8 },
      { "category": "napoje-soki", "categoryLabel": "Napoje", "title": "Woda gazowana", "tag": "", "desc": "500 ml", "price": 8 },
      { "category": "napoje-soki", "categoryLabel": "Napoje", "title": "Pepsi", "tag": "", "desc": "330 ml", "price": 9 },
      { "category": "napoje-soki", "categoryLabel": "Napoje", "title": "Pepsi Max", "tag": "", "desc": "330 ml", "price": 9 },

      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Pomarańczowy", "tag": "świeży sok", "desc": "300 ml", "price": 19 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Grejpfrutowy", "tag": "świeży sok", "desc": "300 ml", "price": 22 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Pomarańczowo-grejpfrutowy", "tag": "świeży sok", "desc": "300 ml", "price": 22 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Jabłkowy", "tag": "świeży sok", "desc": "300 ml", "price": 19 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Jabłkowo-gruszkowy", "tag": "świeży sok", "desc": "300 ml", "price": 19 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Marchewka-jabłko-pomarańcza", "tag": "świeży sok", "desc": "300 ml", "price": 19 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Burak-jabłko-pomarańcza-seler", "tag": "świeży sok", "desc": "300 ml", "price": 22 },
      { "category": "napoje-soki", "categoryLabel": "Świeże soki", "title": "Jabłko-seler-kiwi", "tag": "świeży sok", "desc": "300 ml", "price": 22 },

      { "category": "napoje-soki", "categoryLabel": "Smoothies", "title": "Zielony", "tag": "smoothies", "desc": "350 ml • szpinak, kiwi, pomarańcza, gruszka", "price": 29 },
      { "category": "napoje-soki", "categoryLabel": "Smoothies", "title": "Żółty", "tag": "smoothies", "desc": "350 ml • banan, jabłko, ananas, mango", "price": 29 },
      { "category": "napoje-soki", "categoryLabel": "Smoothies", "title": "Pomarańczowy", "tag": "smoothies", "desc": "350 ml • banan, pomarańcza, mango, nerkowce, limonka", "price": 29 },
      { "category": "napoje-soki", "categoryLabel": "Smoothies", "title": "Czerwony", "tag": "smoothies", "desc": "350 ml • truskawki, maliny, banan, ananas", "price": 29 },

      { "category": "napoje-soki", "categoryLabel": "Piwo", "title": "Corona", "tag": "piwo", "desc": "330 ml", "price": 15 },
      { "category": "napoje-soki", "categoryLabel": "Piwo", "title": "Piwo bezalkoholowe", "tag": "piwo", "desc": "", "price": 14 },
      { "category": "napoje-soki", "categoryLabel": "Piwo", "title": "IPA", "tag": "piwo", "desc": "0,5 l", "price": 19 },
      { "category": "napoje-soki", "categoryLabel": "Piwo", "title": "Lager", "tag": "piwo", "desc": "Zapytaj o dostępność", "price": 17 },

      { "category": "napoje-soki", "categoryLabel": "Wino & Aperitiff", "title": "Sauvignon blanc (białe wytrawne) – Skarby Mołdawii", "tag": "wino-aperitiff", "desc": "170/500/700 ml", "price": "22/64/89",
        "variants": [
          { "label": "170", "price": 22, "size": "170" },
          { "label": "500", "price": 64, "size": "500" },
          { "label": "700 ml", "price": 89, "size": "700 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Wino & Aperitiff", "title": "Cabernet sauvignon (czerwone wytrawne) – Skarby Mołdawii", "tag": "wino-aperitiff", "desc": "170/500/700 ml", "price": "22/64/89",
        "variants": [
          { "label": "170", "price": 22, "size": "170" },
          { "label": "500", "price": 64, "size": "500" },
          { "label": "700 ml", "price": 89, "size": "700 ml" }
        ]
      },
      { "category": "napoje-soki", "categoryLabel": "Wino & Aperitiff", "title": "Hugo", "tag": "wino-aperitiff", "desc": "Prosecco, woda gazowana, syrop z czarnego bzu, mięta i limonka", "price": 35 },
      { "category": "napoje-soki", "categoryLabel": "Wino & Aperitiff", "title": "Prosecco (wytrawne wino musujące)", "tag": "wino-aperitiff", "desc": "", "price": 26 },

      { "category": "shake", "categoryLabel": "Shakes", "title": "Śmietankowy", "tag": "klasyka", "desc": "", "price": 18 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Waniliowy", "tag": "klasyka", "desc": "", "price": 19 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Czekoladowy", "tag": "klasyka", "desc": "", "price": 19 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Straciatella", "tag": "klasyka", "desc": "", "price": 19 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Chałwa", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Krówka", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Daim", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Milky Way", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Oreo", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Snickers", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Ptasie mleczko waniliowe", "tag": "klasyka", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Kinder Bueno", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Reese's Peanut Butter", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Nutella", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Raffaello", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Skittles", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Ferrero Rocher", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Maxi King", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Masło orzechowe", "tag": "klasyka", "desc": "", "price": 24 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Kawowy", "tag": "klasyka", "desc": "", "price": 24 },

      { "category": "shake", "categoryLabel": "Shakes", "title": "Ciasteczkowy Potwór", "tag": "vip", "desc": "", "price": 37 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Pistacjusz", "tag": "vip", "desc": "", "price": 37 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Marshall", "tag": "vip", "desc": "", "price": 37 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Cringe", "tag": "vip", "desc": "", "price": 37 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Cheesecake", "tag": "vip", "desc": "", "price": 37 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Gonzo", "tag": "vip", "desc": "", "price": 37 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Johny Pierniczony", "tag": "vip", "desc": "", "price": 37 },

      { "category": "shake", "categoryLabel": "Shakes", "title": "Banan + maliny", "tag": "best-of", "desc": "", "price": 26 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Mango + truskawki", "tag": "best-of", "desc": "", "price": 26 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Kiwi + mango", "tag": "best-of", "desc": "", "price": 26 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Kinder bueno + maliny", "tag": "best-of", "desc": "", "price": 28 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Oreo + masło orzechowe", "tag": "best-of", "desc": "", "price": 28 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Kawa + słony karmel", "tag": "best-of", "desc": "", "price": 29 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Kawa + Nutella", "tag": "best-of", "desc": "", "price": 29 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Ptasie mleczko + maliny", "tag": "best-of", "desc": "", "price": 28 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Raffaello + jagody", "tag": "best-of", "desc": "", "price": 28 },

      { "category": "shake", "categoryLabel": "Shakes", "title": "Bananowy", "tag": "owocowe", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Czarna porzeczka", "tag": "owocowe", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Malinowy", "tag": "owocowe", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Mango", "tag": "owocowe", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Truskawkowy", "tag": "owocowe", "desc": "", "price": 22 },
      { "category": "shake", "categoryLabel": "Shakes", "title": "Jagodowy", "tag": "owocowe", "desc": "", "price": 22 },

      { "category": "shake", "categoryLabel": "Shakes proteinowe", "title": "Jagodowy muffin", "tag": "proteinowe", "desc": "", "price": 32 },
      { "category": "shake", "categoryLabel": "Shakes proteinowe", "title": "Słony karmel", "tag": "proteinowe", "desc": "", "price": 28 },
      { "category": "shake", "categoryLabel": "Shakes proteinowe", "title": "Truskawkowe love", "tag": "proteinowe", "desc": "", "price": 28 },

      { "category": "deser", "categoryLabel": "Lody włoskie", "title": "Lody włoskie śmietankowe (małe)", "tag": "lody-wloskie", "desc": "150 g", "price": 11 },
      { "category": "deser", "categoryLabel": "Lody włoskie", "title": "Lody włoskie śmietankowe (duże)", "tag": "lody-wloskie", "desc": "250 g", "price": 16 },
      { "category": "deser", "categoryLabel": "Dodatki", "title": "Mus owocowy lub polewa", "tag": "lody-wloskie", "desc": "", "price": 6 },
      { "category": "deser", "categoryLabel": "Dodatki", "title": "M&Ms", "tag": "lody-wloskie", "desc": "", "price": 6 },
      { "category": "deser", "categoryLabel": "Dodatki", "title": "Owoce", "tag": "lody-wloskie", "desc": "", "price": 14 },
      { "category": "deser", "categoryLabel": "Dodatki", "title": "Bita śmietana", "tag": "lody-wloskie", "desc": "", "price": 6 },
      { "category": "deser", "categoryLabel": "Desery lodowe", "title": "Troll", "tag": "desery-lodowe", "desc": "", "price": 24 },
      { "category": "deser", "categoryLabel": "Desery lodowe", "title": "Owocowa aleja", "tag": "desery-lodowe", "desc": "", "price": 38 },
      { "category": "deser", "categoryLabel": "Desery lodowe", "title": "Grzeszna truskawka", "tag": "desery-lodowe", "desc": "", "price": 38 },
      { "category": "deser", "categoryLabel": "Desery lodowe", "title": "Oreo Sundae", "tag": "desery-lodowe", "desc": "", "price": 29 },

      { "category": "deser", "categoryLabel": "Gofry amerykańskie", "title": "Z syropem klonowym, jajkiem sadzonym i bekonem", "tag": "gofry-amerykanskie", "desc": "pół / cały", "price": "28/44",
        "variants": [
          { "label": "pół", "price": 28, "size": "pół" },
          { "label": "cały", "price": 44, "size": "cały" }
        ]
      },
      { "category": "deser", "categoryLabel": "Gofry amerykańskie", "title": "American Pie z pieczonymi jabłkami, cynamonem, domową kruszonką i lodami", "tag": "gofry-amerykanskie", "desc": "pół / cały", "price": "27/49",
        "variants": [
          { "label": "pół", "price": 27, "size": "pół" },
          { "label": "cały", "price": 49, "size": "cały" }
        ]
      },
      { "category": "deser", "categoryLabel": "Gofry amerykańskie", "title": "Z dżemem z czarnej porzeczki i polewą Lotus Biscoff", "tag": "gofry-amerykanskie", "desc": "pół / cały", "price": "26/48",
        "variants": [
          { "label": "pół", "price": 26, "size": "pół" },
          { "label": "cały", "price": 48, "size": "cały" }
        ]
      },
      { "category": "deser", "categoryLabel": "Gofry amerykańskie", "title": "Dubajski z truskawkami", "tag": "gofry-amerykanskie", "desc": "pół / cały", "price": "32/54",
        "variants": [
          { "label": "pół", "price": 32, "size": "pół" },
          { "label": "cały", "price": 54, "size": "cały" }
        ]
      },
      { "category": "deser", "categoryLabel": "Gofry amerykańskie", "title": "Cheesecake z serkiem Philadelphia, masą ciasteczkową, kruszonką i truskawkami", "tag": "gofry-amerykanskie", "desc": "pół / cały", "price": "28/50",
        "variants": [
          { "label": "pół", "price": 28, "size": "pół" },
          { "label": "cały", "price": 50, "size": "cały" }
        ]
      },

      { "category": "deser", "categoryLabel": "Pancakes", "title": "Z syropem klonowym i lodami", "tag": "pancakes", "desc": "3 szt.", "price": 29 },
      { "category": "deser", "categoryLabel": "Pancakes", "title": "Z owocami, musem truskawkowym i lodami", "tag": "pancakes", "desc": "3 szt.", "price": 36 },
      { "category": "deser", "categoryLabel": "Pancakes", "title": "Z Nutellą, truskawkami i lodami", "tag": "pancakes", "desc": "3 szt.", "price": 36 },
      { "category": "deser", "categoryLabel": "Pancakes", "title": "Z masą Kinder Bueno, malinami i lodami", "tag": "pancakes", "desc": "3 szt.", "price": 39 },
      { "category": "deser", "categoryLabel": "Pancakes", "title": "Z masą Raffaello, truskawkami i lodami", "tag": "pancakes", "desc": "3 szt.", "price": 39 },
      { "category": "deser", "categoryLabel": "Pancakes", "title": "Z dubajską pistacją i truskawkami", "tag": "pancakes", "desc": "3 szt.", "price": 39 },
      { "category": "deser", "categoryLabel": "Pancakes", "title": "Hello USA", "tag": "pancakes", "desc": "syrop klonowy, bekon, 2 jaja sadzone", "price": 39 },

      { "category": "texmex", "categoryLabel": "Quesadillas", "title": "Pollo", "tag": "quesadillas", "desc": "", "price": 45 },
      { "category": "texmex", "categoryLabel": "Quesadillas", "title": "Torro", "tag": "quesadillas", "desc": "", "price": 46 },
      { "category": "texmex", "categoryLabel": "Quesadillas", "title": "Camaron", "tag": "quesadillas", "desc": "", "price": 49 },
      { "category": "texmex", "categoryLabel": "Quesadillas", "title": "Verduras", "tag": "quesadillas", "desc": "", "price": 42 },

      { "category": "texmex", "categoryLabel": "Fajita", "title": "Fajita z kurczakiem", "tag": "fajita", "desc": "", "price": 59 },
      { "category": "texmex", "categoryLabel": "Fajita", "title": "Fajita z krewetkami", "tag": "fajita", "desc": "", "price": 69 },
      { "category": "texmex", "categoryLabel": "Fajita", "title": "Fajita z polędwicą wołową", "tag": "fajita", "desc": "", "price": 79 },

      { "category": "texmex", "categoryLabel": "Churros", "title": "Churros (6 szt.) z sosem czekoladowym i truskawkami", "tag": "churros", "desc": "", "price": 33 },
      { "category": "texmex", "categoryLabel": "Churros", "title": "Churros (6 szt.) ze słonym karmelem i precelkami", "tag": "churros", "desc": "", "price": 32 },

      { "category": "texmex", "categoryLabel": "Pasta", "title": "Tagiatelle z krewetkami", "tag": "pasta", "desc": "", "price": 51 },
      { "category": "texmex", "categoryLabel": "Pasta", "title": "Vege Pasta", "tag": "pasta", "desc": "", "price": 44 },

      { "category": "texmex", "categoryLabel": "NY Chinatown Stir Fry", "title": "Vege (z nerkowcami)", "tag": "stir-fry", "desc": "", "price": 39 },
      { "category": "texmex", "categoryLabel": "NY Chinatown Stir Fry", "title": "Z kurczakiem 90g", "tag": "stir-fry", "desc": "", "price": 47 },
      { "category": "texmex", "categoryLabel": "NY Chinatown Stir Fry", "title": "Z wołowiną 90g", "tag": "stir-fry", "desc": "", "price": 55 },
      { "category": "texmex", "categoryLabel": "NY Chinatown Stir Fry", "title": "Z krewetkami (16/20) 7 szt.", "tag": "stir-fry", "desc": "", "price": 51 },
      { "category": "texmex", "categoryLabel": "Dodatki", "title": "Dodatkowe nerkowce 20g", "tag": "stir-fry", "desc": "", "price": 8 },

      { "category": "texmex", "categoryLabel": "Sałaty", "title": "Cezar", "tag": "salaty", "desc": "", "price": 49 },
      { "category": "texmex", "categoryLabel": "Sałaty", "title": "Vege Cezar", "tag": "salaty", "desc": "", "price": 42 },
      { "category": "texmex", "categoryLabel": "Sałaty", "title": "Ale burak", "tag": "salaty", "desc": "", "price": 44 },
      { "category": "texmex", "categoryLabel": "Sałaty", "title": "Alabama", "tag": "salaty", "desc": "", "price": 51 },

      { "category": "kanapki", "categoryLabel": "Startery", "title": "Frytki", "tag": "startery", "desc": "150 g", "price": 15 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Frytki z batatów", "tag": "startery", "desc": "150 g", "price": 19 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Frytki z serem, bekonem i majonezem sriracha", "tag": "startery", "desc": "", "price": 30 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Krążki cebulowe (5 szt.) z sosem sweet chili", "tag": "startery", "desc": "", "price": 18 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Krewetki w tempurze (3 szt.) z sosem sweet chili", "tag": "startery", "desc": "", "price": 21 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Krewetki w tempurze (6 szt.) z sosem sweet chili", "tag": "startery", "desc": "", "price": 39 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Nachos z serem, guacamole, śmietaną, salsą i jalapeno", "tag": "startery", "desc": "", "price": 41 },
      { "category": "kanapki", "categoryLabel": "Startery", "title": "Nachos z chili con carne, serem, śmietaną, guacamole i jalapeno", "tag": "startery", "desc": "", "price": 49 },

      { "category": "kanapki", "categoryLabel": "Kanapki", "title": "Rostbef", "tag": "kanapki", "desc": "60 g / 100 g", "price": "42/58",
        "variants": [
          { "label": "60 g", "price": 42, "size": "60 g" },
          { "label": "100 g", "price": 58, "size": "100 g" }
        ]
      },
      { "category": "kanapki", "categoryLabel": "Kanapki", "title": "Cotto", "tag": "kanapki", "desc": "70 g / 120 g", "price": "37/49",
        "variants": [
          { "label": "70 g", "price": 37, "size": "70 g" },
          { "label": "120 g", "price": 49, "size": "120 g" }
        ]
      },
      { "category": "kanapki", "categoryLabel": "Kanapki", "title": "Kura", "tag": "kanapki", "desc": "", "price": 46 },
      { "category": "kanapki", "categoryLabel": "Kanapki", "title": "Club sandwich", "tag": "kanapki", "desc": "", "price": 38 },
      { "category": "kanapki", "categoryLabel": "Kanapki", "title": "Cotto club", "tag": "kanapki", "desc": "", "price": 36 },
      { "category": "kanapki", "categoryLabel": "Kanapki", "title": "Vege club", "tag": "kanapki", "desc": "", "price": 36 },

      { "category": "kanapki", "categoryLabel": "Dania główne", "title": "Tatar z polędwicy wołowej", "tag": "dania-glowne", "desc": "100 g", "price": 51 },
      { "category": "kanapki", "categoryLabel": "Dania główne", "title": "Żebro wieprzowe", "tag": "dania-glowne", "desc": "450 g", "price": 75 },
      { "category": "kanapki", "categoryLabel": "Dania główne", "title": "Stek", "tag": "dania-glowne", "desc": "", "price": 125 },
      { "category": "kanapki", "categoryLabel": "Dania główne", "title": "Kurczak supreme", "tag": "dania-glowne", "desc": "", "price": 65 },

      { "category": "kanapki", "categoryLabel": "Zestawy", "title": "Burger + frytki lub sałatka", "tag": "zestawy", "desc": "oszczędzasz 5 PLN", "price": "+12",
        "variants": [
          { "label": "dopłata", "price": 12.0, "size": null }
        ]
      },
      { "category": "kanapki", "categoryLabel": "Zestawy", "title": "Burger + frytki/sałatka + lemoniada cytrusowa", "tag": "zestawy", "desc": "oszczędzasz 10 PLN", "price": "+22",
        "variants": [
          { "label": "dopłata", "price": 22.0, "size": null }
        ]
      },
      { "category": "kanapki", "categoryLabel": "Zestawy", "title": "Zamień frytki na krążki cebulowe", "tag": "zestawy", "desc": "", "price": 15 },
      { "category": "kanapki", "categoryLabel": "Zestawy", "title": "Zamień frytki na mini nachos", "tag": "zestawy", "desc": "", "price": 18 },
      { "category": "kanapki", "categoryLabel": "Zestawy", "title": "Zamień frytki na bataty", "tag": "zestawy", "desc": "", "price": 14 },

      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Prostak", "tag": "wolowy", "desc": "mały / średni / duży", "price": "30/38/46",
        "variants": [
          { "label": "mały", "price": 30, "size": "mały" },
          { "label": "średni", "price": 38, "size": "średni" },
          { "label": "duży", "price": 46, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Sergio", "tag": "wolowy", "desc": "mały / średni / duży", "price": "32/40/48",
        "variants": [
          { "label": "mały", "price": 32, "size": "mały" },
          { "label": "średni", "price": 40, "size": "średni" },
          { "label": "duży", "price": 48, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Boston", "tag": "wolowy", "desc": "mały / średni / duży", "price": "34/42/50",
        "variants": [
          { "label": "mały", "price": 34, "size": "mały" },
          { "label": "średni", "price": 42, "size": "średni" },
          { "label": "duży", "price": 50, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Pleśniak", "tag": "wolowy", "desc": "mały / średni / duży", "price": "38/46/54",
        "variants": [
          { "label": "mały", "price": 38, "size": "mały" },
          { "label": "średni", "price": 46, "size": "średni" },
          { "label": "duży", "price": 54, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Bajpas", "tag": "wolowy", "desc": "mały / średni / duży", "price": "36/44/52",
        "variants": [
          { "label": "mały", "price": 36, "size": "mały" },
          { "label": "średni", "price": 44, "size": "średni" },
          { "label": "duży", "price": 52, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Burakoza", "tag": "wolowy", "desc": "mały / średni / duży", "price": "38/46/54",
        "variants": [
          { "label": "mały", "price": 38, "size": "mały" },
          { "label": "średni", "price": 46, "size": "średni" },
          { "label": "duży", "price": 54, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "New York", "tag": "wolowy", "desc": "mały / średni / duży", "price": "38/46/54",
        "variants": [
          { "label": "mały", "price": 38, "size": "mały" },
          { "label": "średni", "price": 46, "size": "średni" },
          { "label": "duży", "price": 54, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Złodziej", "tag": "wolowy", "desc": "mały / średni / duży", "price": "38/46/54",
        "variants": [
          { "label": "mały", "price": 38, "size": "mały" },
          { "label": "średni", "price": 46, "size": "średni" },
          { "label": "duży", "price": 54, "size": "duży" }
        ]
      },
      { "category": "burger", "categoryLabel": "Burgery wołowe Black Angus", "title": "Missisipi", "tag": "wolowy", "desc": "mały / średni / duży", "price": "38/46/54",
        "variants": [
          { "label": "mały", "price": 38, "size": "mały" },
          { "label": "średni", "price": 46, "size": "średni" },
          { "label": "duży", "price": 54, "size": "duży" }
        ]
      },

      { "category": "burger", "categoryLabel": "Burgery z kurczakiem", "title": "Kura", "tag": "kurczak", "desc": "", "price": 43 },
      { "category": "burger", "categoryLabel": "Burgery z kurczakiem", "title": "Żółtodziób", "tag": "kurczak", "desc": "", "price": 43 },

      { "category": "sniadania", "categoryLabel": "Napoje do śniadania", "title": "Kawa filtrowana (z dolewką)", "tag": "sniadania", "desc": "", "price": 12 },
      { "category": "sniadania", "categoryLabel": "Napoje do śniadania", "title": "Herbata śniadaniowa", "tag": "sniadania", "desc": "", "price": 9 },
      { "category": "sniadania", "categoryLabel": "Napoje do śniadania", "title": "Świeży sok", "tag": "sniadania", "desc": "0,2 l", "price": 18 },
      { "category": "sniadania", "categoryLabel": "Napoje do śniadania", "title": "Mimoza", "tag": "sniadania", "desc": "", "price": 31 },

      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Granola", "tag": "sniadania", "desc": "", "price": 44 },
      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Tost francuski w panko", "tag": "sniadania", "desc": "", "price": 44 },
      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Jajito burrito", "tag": "sniadania", "desc": "", "price": 37 },
      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Czerwona szakszuka", "tag": "sniadania", "desc": "", "price": 39 },
      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Egg royal", "tag": "sniadania", "desc": "", "price": 45 },
      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Jajecznica", "tag": "sniadania", "desc": "", "price": 33 },
      { "category": "sniadania", "categoryLabel": "Śniadania", "title": "Omlet francuski", "tag": "sniadania", "desc": "", "price": 37 },

      { "category": "sniadania", "categoryLabel": "Kanapki śniadaniowe", "title": "Rostbef", "tag": "kanapki-sniadaniowe", "desc": "60 g / 100 g", "price": "42/58",
        "variants": [
          { "label": "60 g", "price": 42, "size": "60 g" },
          { "label": "100 g", "price": 58, "size": "100 g" }
        ]
      },
      { "category": "sniadania", "categoryLabel": "Kanapki śniadaniowe", "title": "Cotto", "tag": "kanapki-sniadaniowe", "desc": "70 g / 120 g", "price": "37/49",
        "variants": [
          { "label": "70 g", "price": 37, "size": "70 g" },
          { "label": "120 g", "price": 49, "size": "120 g" }
        ]
      },
      { "category": "sniadania", "categoryLabel": "Kanapki śniadaniowe", "title": "Kura", "tag": "kanapki-sniadaniowe", "desc": "", "price": 46 },
      { "category": "sniadania", "categoryLabel": "Kanapki śniadaniowe", "title": "Club sandwich", "tag": "kanapki-sniadaniowe", "desc": "", "price": 38 },
      { "category": "sniadania", "categoryLabel": "Kanapki śniadaniowe", "title": "Cotto club", "tag": "kanapki-sniadaniowe", "desc": "", "price": 36 },
      { "category": "sniadania", "categoryLabel": "Kanapki śniadaniowe", "title": "Vege club", "tag": "kanapki-sniadaniowe", "desc": "", "price": 36 },

      { "category": "sniadania", "categoryLabel": "Full milkshake breakfast", "title": "Duży full milkshake breakfast", "tag": "zestaw-sniadaniowy", "desc": "", "price": 53 },
      { "category": "sniadania", "categoryLabel": "Full milkshake breakfast", "title": "Mały full milkshake breakfast", "tag": "zestaw-sniadaniowy", "desc": "", "price": 42 },

      { "category": "sniadania", "categoryLabel": "Chiquita", "title": "Chiquita", "tag": "chiquita", "desc": "", "price": 41 },
      { "category": "sniadania", "categoryLabel": "Chiquita", "title": "Chiquita z chorizo", "tag": "chiquita", "desc": "80 g", "price": 39 },

      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Frankfurterka", "tag": "sniadania-keto", "desc": "", "price": 7 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Chorizo", "tag": "sniadania-keto", "desc": "70 g", "price": 8 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "½ awokado", "tag": "sniadania-keto", "desc": "", "price": 9 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Twarożek", "tag": "sniadania-keto", "desc": "80 g", "price": 7 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Ogórek zielony", "tag": "sniadania-keto", "desc": "7 plastrów", "price": 5 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Pomidorki koktajlowe", "tag": "sniadania-keto", "desc": "80 g", "price": 5 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Bekon", "tag": "sniadania-keto", "desc": "2 plastry", "price": 4 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Jajo", "tag": "sniadania-keto", "desc": "", "price": 4 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Masło", "tag": "sniadania-keto", "desc": "10 g", "price": 2 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Chleb maślany", "tag": "sniadania-keto", "desc": "80 g", "price": 6 },
      { "category": "sniadania", "categoryLabel": "Śniadanie KETO – dodatki", "title": "Gravlax", "tag": "sniadania-keto", "desc": "50 g", "price": 15 }
    ]
  };

  /* -------------------------
     Nagrody (NOWE – 3 szt.)
     ------------------------- */
  const REWARDS = [
    { id: "milkshake_30", title: "Milkshake do 30 PLN", points: 25, desc: "Realizacja: milkshake o wartości do 30 PLN." },
    { id: "burger_set_60", title: "Zestaw burger do 60 PLN", points: 50, desc: "Realizacja: zestaw burger o wartości do 60 PLN." },
    { id: "order_120", title: "Zamówienie do 120 PLN", points: 100, desc: "Realizacja: zamówienie o wartości do 120 PLN." }
  ];

  /* -------------------------
     Helpers / storage
     ------------------------- */
  const LS = {
    user: "milk_user",
    points: "milk_points",
    pointsHistory: "milk_points_history",
    cart: "milk_cart",
    orders: "milk_orders",
    reservations: "milk_reservations",
    profile: "milk_profile",
    redeemed: "milk_redeemed_rewards",
    lang: "milk_lang",
    didResetHistory: "milk_points_history_reset_v1"
  };

  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => Array.from(document.querySelectorAll(sel));

  const nowISO = () => new Date().toISOString();

  const safeJsonParse = (s, fallback) => {
    try { return JSON.parse(s); } catch { return fallback; }
  };

  const store = {
    get(key, fallback){
      const raw = localStorage.getItem(key);
      if (raw == null) return fallback;
      return safeJsonParse(raw, fallback);
    },
    set(key, val){
      localStorage.setItem(key, JSON.stringify(val));
    },
    del(key){
      localStorage.removeItem(key);
    }
  };

  const fmtPLN = (n) => {
    const num = Number(n);
    if (!Number.isFinite(num)) return String(n);
    return num.toFixed(num % 1 === 0 ? 0 : 2).replace(".", ",");
  };

  const toast = (() => {
    let tmr = null;
    const el = $("#toast");
    const title = $("#toastTitle");
    const msg = $("#toastMsg");
    const close = $("#toastClose");
    if (close) close.addEventListener("click", () => hide());

    function show(t, m){
      if (!el) return;
      title.textContent = t || "Info";
      msg.textContent = m || "";
      el.classList.add("show");
      clearTimeout(tmr);
      tmr = setTimeout(() => hide(), 3200);
    }
    function hide(){
      if (!el) return;
      el.classList.remove("show");
      clearTimeout(tmr);
      tmr = null;
    }
    return { show, hide };
  })();

  /* -------------------------
     User / auth
     ------------------------- */
  const getUser = () => store.get(LS.user, null);
  const setUser = (u) => store.set(LS.user, u);
  const isLoggedIn = () => !!(getUser() && getUser().email);

  function hashTo6Digits(str){
    // deterministyczny 6-cyfrowy Milk ID na bazie e-maila
    let h = 2166136261;
    for (let i=0;i<str.length;i++){
      h ^= str.charCodeAt(i);
      h = Math.imul(h, 16777619);
    }
    const n = Math.abs(h) % 1000000;
    return String(n).padStart(6, "0");
  }

  function getMilkIdForUser(){
    const u = getUser();
    if (!u?.email) return null;
    return hashTo6Digits(String(u.email).trim().toLowerCase());
  }

  /* -------------------------
     Points
     ------------------------- */
  function initPointsIfMissing(){
    const p = store.get(LS.points, null);
    if (p == null) store.set(LS.points, 0);
    const hist = store.get(LS.pointsHistory, null);
    if (!Array.isArray(hist)) store.set(LS.pointsHistory, []);

    // (z wcześniejszych wersji) 1x reset historii – zostawiamy, bo masz to w pamięci projektu
    const did = store.get(LS.didResetHistory, false);
    if (!did){
      store.set(LS.pointsHistory, []);
      store.set(LS.didResetHistory, true);
    }
  }

  const getPoints = () => Number(store.get(LS.points, 0) || 0);
  const setPoints = (n) => store.set(LS.points, Math.max(0, Number(n) || 0));

  function addPointsHistory(entry){
    const hist = store.get(LS.pointsHistory, []);
    hist.unshift(entry);
    store.set(LS.pointsHistory, hist.slice(0, 40));
  }

  function applyPointsDelta(delta, reason){
    const prev = getPoints();
    const next = Math.max(0, prev + delta);
    setPoints(next);
    addPointsHistory({
      at: nowISO(),
      delta,
      reason: reason || (delta >= 0 ? "Dodano punkty" : "Odjęto punkty")
    });
    renderPoints();
  }

  /* -------------------------
     Status / hours
     ------------------------- */
  const HOURS = {
    monThu: "12:00–22:00",
    fri: "12:00–23:00",
    sat: "12:00–23:00",
    sun: "12:00–22:00"
  };

  function isOpenNow(){
    // prosta logika statusu (możesz podmienić realnymi godzinami)
    // Dla UI: tylko “otwarte/zamknięte” na podstawie stałych godzin.
    const d = new Date();
    const day = d.getDay(); // 0 sun ... 6 sat
    const min = d.getHours()*60 + d.getMinutes();

    const parseRange = (range) => {
      const [a,b] = range.split("–");
      const toMin = (t) => {
        const [hh,mm] = t.split(":").map(Number);
        return hh*60 + mm;
      };
      return [toMin(a), toMin(b)];
    };

    let range = HOURS.sun;
    if (day >= 1 && day <= 4) range = HOURS.monThu;
    else if (day === 5) range = HOURS.fri;
    else if (day === 6) range = HOURS.sat;

    const [start,end] = parseRange(range);
    return min >= start && min <= end;
  }

  function renderHours(expanded){
    $("#h1").textContent = HOURS.monThu;
    $("#h2").textContent = HOURS.fri;
    $("#h3").textContent = HOURS.sat;
    $("#h4").textContent = HOURS.sun;
    $("#hoursGrid").classList.toggle("hide", !expanded);
  }

  function renderStatus(){
    const open = isOpenNow();
    const badge = $("#statusBadge");
    const txt = $("#statusText");
    const sub = $("#statusSub");

    if (!badge || !txt || !sub) return;

    badge.classList.remove("warn","bad");
    const dot = badge.querySelector(".b-dot");

    if (open){
      txt.textContent = "Otwarte";
      sub.textContent = "Wpadnij do nas — działamy!";
      if (dot) dot.style.background = "var(--good)";
    } else {
      txt.textContent = "Zamknięte";
      sub.textContent = "Aktualnie nieczynne — sprawdź godziny.";
      badge.classList.add("warn");
      if (dot) dot.style.background = "var(--warn)";
    }
  }

  /* -------------------------
     Tabs / pages
     ------------------------- */
  function showPage(tab){
    const map = {
      points: "#pagePoints",
      rewards: "#pageRewards",
      order: "#pageOrder",
      reservations: "#pageReservations",
      account: "#pageAccount"
    };
    $$(".page").forEach(p => p.classList.remove("active"));
    $$(".nav-btn").forEach(b => b.classList.remove("active"));

    const pageSel = map[tab] || "#pagePoints";
    const page = $(pageSel);
    if (page) page.classList.add("active");

    const btn = $(`.nav-btn[data-tab="${tab}"]`);
    if (btn) btn.classList.add("active");

    // kart-fab tylko na Zamów
    $("#cartFab").style.display = (tab === "order" && getCartCount() > 0) ? "block" : "none";
  }

  /* -------------------------
     Menu normalization
     ------------------------- */
  const MAIN_CATS = [
    { id: "kawa-herbata", label: "Kawa" },
    { id: "napoje-soki", label: "Napoje" },
    { id: "shake", label: "Shakes" },
    { id: "deser", label: "Desery" },
    { id: "texmex", label: "Tex Mex" },
    { id: "kanapki", label: "Kanapki" },
    { id: "burger", label: "Burgery" },
    { id: "sniadania", label: "Śniadania" }
  ];

  function menuItemsByMainCategory(catId){
    return MENU_CATALOG.items.filter(it => it.category === catId);
  }

  function itemBaseId(it, idx){
    // stabilne id (tytuł+cat+idx)
    return `${it.category}::${idx}::${String(it.title).toLowerCase().replace(/\s+/g,"-")}`;
  }

  function itemDisplayPrice(it){
    if (Array.isArray(it.variants) && it.variants.length){
      const prices = it.variants.map(v => v.price).filter(n => Number.isFinite(Number(n)));
      if (prices.length){
        const min = Math.min(...prices);
        const max = Math.max(...prices);
        return min === max ? `${fmtPLN(min)} PLN` : `${fmtPLN(min)}–${fmtPLN(max)} PLN`;
      }
    }
    // price może być string typu "12/17" albo "+12"
    if (typeof it.price === "string") return `${it.price} PLN`;
    return `${fmtPLN(it.price)} PLN`;
  }

  /* -------------------------
     Cart
     ------------------------- */
  const getCart = () => store.get(LS.cart, []);
  const setCart = (c) => store.set(LS.cart, c);

  function getCartCount(){
    return getCart().reduce((a,it) => a + (it.qty || 0), 0);
  }
  function getCartTotal(){
    return getCart().reduce((a,it) => a + (Number(it.unitPrice)||0) * (it.qty||0), 0);
  }

  function addToCart(product, variant){
    // product: {id,title,desc,tag,categoryLabel}
    // variant: {label, price, size} | null
    const vLabel = variant?.label ? String(variant.label) : null;
    const vSize = variant?.size ? String(variant.size) : null;
    const unitPrice = Number(variant?.price ?? product.priceNumber ?? product.price ?? 0);

    const key = `${product.id}::${vLabel||""}::${vSize||""}::${unitPrice}`;
    const cart = getCart();
    const found = cart.find(x => x.key === key);
    if (found){
      found.qty = (found.qty || 0) + 1;
    } else {
      cart.push({
        key,
        productId: product.id,
        title: product.title,
        desc: product.desc || "",
        category: product.mainCategory || "",
        variantLabel: vLabel,
        variantSize: vSize,
        unitPrice,
        qty: 1
      });
    }
    setCart(cart);
    toast.show("Dodano do koszyka", product.title + (vLabel ? ` • ${vLabel}` : ""));
    renderCartFab();
    renderCartModal();
  }

  function decCartItem(key){
    const cart = getCart();
    const it = cart.find(x => x.key === key);
    if (!it) return;
    it.qty = (it.qty || 0) - 1;
    const next = cart.filter(x => (x.qty || 0) > 0);
    setCart(next);
    renderCartFab();
    renderCartModal();
  }

  function incCartItem(key){
    const cart = getCart();
    const it = cart.find(x => x.key === key);
    if (!it) return;
    it.qty = (it.qty || 0) + 1;
    setCart(cart);
    renderCartFab();
    renderCartModal();
  }

  function removeCartItem(key){
    const cart = getCart().filter(x => x.key !== key);
    setCart(cart);
    renderCartFab();
    renderCartModal();
  }

  function clearCart(){
    setCart([]);
    renderCartFab();
    renderCartModal();
  }

  /* -------------------------
     Orders
     ------------------------- */
  const getOrders = () => store.get(LS.orders, []);
  const setOrders = (o) => store.set(LS.orders, o);

  function pickupLeadMinutes(){
    const d = new Date();
    const day = d.getDay(); // 0 sun, 6 sat
    // Mon-Thu: 30, Fri-Sun: 45
    if (day >= 1 && day <= 4) return 30;
    return 45;
  }

  function setDefaultPickupTime(){
    const el = $("#checkoutTime");
    if (!el) return;
    const d = new Date();
    d.setMinutes(d.getMinutes() + pickupLeadMinutes());
    const hh = String(d.getHours()).padStart(2,"0");
    const mm = String(d.getMinutes()).padStart(2,"0");
    el.value = `${hh}:${mm}`;
  }

  async function placeOrder(){
    if (!isLoggedIn()){
      toast.show("Wymagane logowanie", "Zaloguj się, aby złożyć zamówienie.");
      showPage("account");
      return;
    }

    const cart = getCart();
    if (!cart.length){
      toast.show("Koszyk pusty", "Dodaj produkty do koszyka.");
      return;
    }

    const name = ($("#checkoutName").value || "").trim();
    const phone = ($("#checkoutPhone").value || "").trim();
    const location = ($("#checkoutLocation").value || "Słupsk").trim();
    const time = ($("#checkoutTime").value || "").trim();
    const notes = ($("#checkoutNotes").value || "").trim();

    if (!name || !phone){
      toast.show("Brak danych", "Podaj imię i telefon.");
      return;
    }
    if (!time){
      toast.show("Brak godziny", "Wybierz godzinę odbioru.");
      return;
    }
    if (location === "Rowy"){
      toast.show("Rowy wyłączone", "Odbiór w Rowach jest chwilowo wyłączony.");
      return;
    }

    const u = getUser();
    const payload = {
      createdAt: nowISO(),
      email: u.email,
      milkId: getMilkIdForUser(),
      customer: { name, phone },
      pickup: { location, time, notes },
      items: cart.map(it => ({
        title: it.title,
        variant: it.variantLabel || null,
        unitPrice: it.unitPrice,
        qty: it.qty
      })),
      total: getCartTotal()
    };

    // próbujemy serwer
    let ok = false;
    let serverMsg = "";
    try{
      const r = await fetch("/api/orders", {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(payload)
      });
      if (r.ok){
        ok = true;
        try{
          const js = await r.json();
          if (js?.message) serverMsg = js.message;
          if (js?.orderId) payload.orderId = js.orderId;
        }catch{}
      }
    }catch{}

    // lokalny zapis (zawsze)
    const orders = getOrders();
    orders.unshift({ ...payload, status: ok ? "Wysłane" : "Zapisane lokalnie", id: payload.orderId || ("local_" + Date.now()) });
    setOrders(orders.slice(0, 40));

    clearCart();
    renderOrders();

    toast.show("Zamówienie przyjęte", ok ? (serverMsg || "Wysłano na serwer.") : "Brak połączenia — zapis lokalny.");
    closeModal("#cartModal");
  }

  /* -------------------------
     Reservations
     ------------------------- */
  const getReservations = () => store.get(LS.reservations, []);
  const setReservations = (r) => store.set(LS.reservations, r);

  async function sendReservation(){
    if (!isLoggedIn()){
      toast.show("Wymagane logowanie", "Zaloguj się, aby wysłać rezerwację.");
      showPage("account");
      return;
    }

    const name = ($("#resName").value || "").trim();
    const phone = ($("#resPhone").value || "").trim();
    const date = ($("#resDate").value || "").trim();
    const time = ($("#resTime").value || "").trim();
    const people = ($("#resPeople").value || "").trim();
    const notes = ($("#resNotes").value || "").trim();

    if (!name || !phone || !date || !time || !people){
      toast.show("Uzupełnij dane", "Imię, telefon, data, godzina i liczba osób są wymagane.");
      return;
    }

    const u = getUser();
    const payload = {
      createdAt: nowISO(),
      email: u.email,
      milkId: getMilkIdForUser(),
      name, phone, date, time, people: Number(people) || people, notes
    };

    let ok = false;
    try{
      const r = await fetch("/api/rezerwacje", {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(payload)
      });
      ok = r.ok;
      if (ok){
        try{
          const js = await r.json();
          if (js?.id) payload.id = js.id;
        }catch{}
      }
    }catch{}

    const list = getReservations();
    list.unshift({ ...payload, status: ok ? "Wysłano" : "Lokalnie", id: payload.id || ("local_" + Date.now()) });
    setReservations(list.slice(0, 40));

    renderReservations();
    toast.show("Rezerwacja zapisana", ok ? "Wysłano na serwer." : "Brak połączenia — zapis lokalny.");
    $("#resHint").textContent = ok ? "Wysłano rezerwację na serwer." : "Zapisano lokalnie (spróbuj później ponownie).";
  }

  function deleteReservation(id){
    const list = getReservations().filter(x => x.id !== id);
    setReservations(list);
    renderReservations();
    toast.show("Usunięto", "Rezerwacja usunięta lokalnie.");
  }

  /* -------------------------
     Rewards
     ------------------------- */
  const getRedeemed = () => store.get(LS.redeemed, []);
  const setRedeemed = (r) => store.set(LS.redeemed, r);

  async function redeemReward(rewardId){
    const rw = REWARDS.find(r => r.id === rewardId);
    if (!rw) return;

    if (!isLoggedIn()){
      toast.show("Wymagane logowanie", "Zaloguj się, aby realizować nagrody.");
      showPage("account");
      return;
    }

    const pts = getPoints();
    if (pts < rw.points){
      toast.show("Za mało punktów", `Potrzebujesz ${rw.points} pkt.`);
      return;
    }

    // próbujemy endpoint (jeśli istnieje), ale mamy fallback lokalny
    let ok = false;
    try{
      const r = await fetch("/api/rewards/redeem", {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify({
          rewardId: rw.id,
          email: getUser().email,
          milkId: getMilkIdForUser(),
          at: nowISO()
        })
      });
      ok = r.ok;
    }catch{}

    applyPointsDelta(-rw.points, `Realizacja nagrody: ${rw.title}`);

    const redeemed = getRedeemed();
    redeemed.unshift({
      id: "redeem_" + Date.now(),
      rewardId: rw.id,
      title: rw.title,
      points: rw.points,
      at: nowISO(),
      status: ok ? "Zarejestrowano" : "Lokalnie"
    });
    setRedeemed(redeemed.slice(0, 30));

    toast.show("Zrealizowano nagrodę", ok ? "Zapisano na serwerze." : "Zapis lokalny (offline).");
    renderRewards();
  }

  /* -------------------------
     Rendering
     ------------------------- */
  function renderPoints(){
    const pts = getPoints();
    const p1 = $("#pointsValue");
    const p2 = $("#pointsBig");
    if (p1) p1.textContent = String(pts);
    if (p2) p2.textContent = String(pts);

    // do najbliższej nagrody
    const next = [...REWARDS].sort((a,b)=>a.points-b.points).find(r => r.points > pts);
    const toNext = $("#toNext");
    if (toNext){
      if (!next) toNext.textContent = "Masz na wszystkie 🎉";
      else toNext.textContent = `${next.points - pts} pkt`;
    }

    // historia
    const histEl = $("#pointsHistory");
    if (histEl){
      const hist = store.get(LS.pointsHistory, []);
      if (!hist.length){
        histEl.innerHTML = `<div class="mini">Brak historii.</div>`;
      } else {
        histEl.innerHTML = hist.map(h => {
          const d = new Date(h.at);
          const delta = Number(h.delta)||0;
          const sign = delta >= 0 ? "+" : "";
          return `
            <div class="item">
              <div class="meta">
                <b>${h.reason || "Operacja"}</b>
                <span>${d.toLocaleString("pl-PL")}</span>
              </div>
              <div class="right">
                <div class="price">${sign}${delta} pkt</div>
              </div>
            </div>
          `;
        }).join("");
      }
    }
  }

  function renderRewards(){
    const el = $("#rewardsList");
    if (!el) return;

    const pts = getPoints();
    el.innerHTML = REWARDS.map(r => {
      const disabled = pts < r.points;
      return `
        <div class="item">
          <div class="meta">
            <b>${r.title}</b>
            <span>${r.desc}</span>
          </div>
          <div class="right">
            <div class="price">${r.points} pkt</div>
            <button class="btn small ${disabled ? "ghost" : "primary"}" data-reward="${r.id}" ${disabled ? "disabled" : ""}>
              ${disabled ? "Brak pkt" : "Zrealizuj"}
            </button>
          </div>
        </div>
      `;
    }).join("");

    // bind
    el.querySelectorAll("button[data-reward]").forEach(btn => {
      btn.addEventListener("click", () => redeemReward(btn.getAttribute("data-reward")));
    });
  }

  function renderOrderCategories(activeCat){
    const wrap = $("#orderCategories");
    if (!wrap) return;

    const current = activeCat || store.get("milk_active_cat", MAIN_CATS[0].id);
    store.set("milk_active_cat", current);

    wrap.innerHTML = MAIN_CATS.map(c => `
      <button class="chip ${c.id === current ? "active" : ""}" data-cat="${c.id}">
        ${c.label}
      </button>
    `).join("");

    wrap.querySelectorAll(".chip").forEach(ch => {
      ch.addEventListener("click", () => {
        const id = ch.getAttribute("data-cat");
        renderOrderCategories(id);
        renderOrderProducts(id);
      });
    });
  }

  function renderOrderProducts(catId){
    const list = $("#orderProducts");
    if (!list) return;

    const items = menuItemsByMainCategory(catId);
    if (!items.length){
      list.innerHTML = `<div class="mini">Brak produktów w tej kategorii.</div>`;
      return;
    }

    list.innerHTML = items.map((it, idx) => {
      const pid = itemBaseId(it, idx);
      const hasVar = Array.isArray(it.variants) && it.variants.length;
      const priceTxt = itemDisplayPrice(it);
      const desc = (it.desc || "").trim();
      const tag = (it.tag || "").trim();

      if (!hasVar){
        return `
          <div class="item">
            <div class="meta">
              <b>${it.title}</b>
              <span>${[tag, desc].filter(Boolean).join(" • ")}</span>
            </div>
            <div class="right">
              <div class="price">${priceTxt}</div>
              <button class="btn small primary" data-add="${pid}">Dodaj</button>
            </div>
          </div>
        `;
      }

      const options = it.variants.map((v, i) => {
        const lbl = (v.label || v.size || `wariant ${i+1}`).toString();
        return `<option value="${i}">${lbl} — ${fmtPLN(v.price)} PLN</option>`;
      }).join("");

      return `
        <div class="item">
          <div class="meta">
            <b>${it.title}</b>
            <span>${[tag, desc].filter(Boolean).join(" • ")}</span>
            <div style="margin-top:8px">
              <select class="input" style="padding:10px 12px;border-radius:14px" data-variant-select="${pid}">
                ${options}
              </select>
            </div>
          </div>
          <div class="right">
            <div class="price">${priceTxt}</div>
            <button class="btn small primary" data-add="${pid}">Dodaj</button>
          </div>
        </div>
      `;
    }).join("");

    // bind add buttons
    list.querySelectorAll("button[data-add]").forEach(btn => {
      btn.addEventListener("click", () => {
        const pid = btn.getAttribute("data-add");
        const idx = parseInt(pid.split("::")[1], 10);
        const it = items[idx];
        const hasVar = Array.isArray(it.variants) && it.variants.length;

        const product = {
          id: pid,
          title: it.title,
          desc: it.desc || "",
          tag: it.tag || "",
          mainCategory: catId,
          priceNumber: (typeof it.price === "number") ? it.price : null
        };

        if (!hasVar){
          addToCart(product, null);
          return;
        }

        const sel = list.querySelector(`select[data-variant-select="${pid}"]`);
        const vi = sel ? Number(sel.value) : 0;
        const v = it.variants[vi] || it.variants[0];
        addToCart(product, v);
      });
    });

    renderCartFab();
  }

  function renderCartFab(){
    const fab = $("#cartFab");
    const c = getCartCount();
    const t = getCartTotal();
    $("#fabCount").textContent = String(c);
    $("#fabTotal").textContent = fmtPLN(t);
    $("#cartTotal").textContent = fmtPLN(t);
    if (fab) fab.style.display = (showingTab() === "order" && c > 0) ? "block" : "none";
  }

  function renderCartModal(){
    const list = $("#cartList");
    if (!list) return;

    const cart = getCart();
    if (!cart.length){
      list.innerHTML = `<div class="mini">Koszyk jest pusty.</div>`;
      $("#cartTotal").textContent = "0";
      renderCartFab();
      return;
    }

    list.innerHTML = cart.map(it => {
      const vv = it.variantLabel ? ` • ${it.variantLabel}` : "";
      return `
        <div class="item">
          <div class="meta">
            <b>${it.title}${vv}</b>
            <span>${it.desc || ""}</span>
          </div>
          <div class="right">
            <div class="price">${fmtPLN(it.unitPrice)} PLN</div>
            <div style="display:flex;gap:8px;align-items:center">
              <button class="btn small ghost" data-dec="${it.key}">−</button>
              <div style="min-width:28px;text-align:center;font-weight:900">${it.qty}</div>
              <button class="btn small ghost" data-inc="${it.key}">+</button>
            </div>
            <button class="btn small ghost" data-rm="${it.key}">Usuń</button>
          </div>
        </div>
      `;
    }).join("");

    list.querySelectorAll("button[data-dec]").forEach(b => b.addEventListener("click", () => decCartItem(b.getAttribute("data-dec"))));
    list.querySelectorAll("button[data-inc]").forEach(b => b.addEventListener("click", () => incCartItem(b.getAttribute("data-inc"))));
    list.querySelectorAll("button[data-rm]").forEach(b => b.addEventListener("click", () => removeCartItem(b.getAttribute("data-rm"))));

    const total = getCartTotal();
    $("#cartTotal").textContent = fmtPLN(total);

    // hint o regule odbioru
    const lead = pickupLeadMinutes();
    $("#pickupRuleHint").textContent = `Minimalny czas przygotowania: ${lead} min (${lead === 30 ? "Pon–Czw" : "Pią–Nie"}).`;

    renderCartFab();
  }

  function renderOrders(){
    const el = $("#ordersList");
    if (!el) return;

    const orders = getOrders();
    if (!orders.length){
      el.innerHTML = `<div class="mini">Brak zamówień.</div>`;
      return;
    }

    el.innerHTML = orders.map(o => {
      const d = new Date(o.createdAt);
      const total = fmtPLN(o.total || 0);
      const items = (o.items || []).slice(0,3).map(i => `${i.title}${i.variant ? ` (${i.variant})` : ""} ×${i.qty}`).join(", ");
      return `
        <div class="item">
          <div class="meta">
            <b>${o.status || "Zamówienie"}</b>
            <span>${d.toLocaleString("pl-PL")} • ${o.pickup?.location || "Słupsk"} • odbiór ${o.pickup?.time || "—"}</span>
            <span>${items}${(o.items||[]).length>3 ? "…" : ""}</span>
          </div>
          <div class="right">
            <div class="price">${total} PLN</div>
          </div>
        </div>
      `;
    }).join("");
  }

  function renderReservations(){
    const el = $("#resList");
    if (!el) return;

    const list = getReservations();
    if (!list.length){
      el.innerHTML = `<div class="mini">Brak rezerwacji.</div>`;
      return;
    }

    el.innerHTML = list.map(r => {
      const d = new Date(r.createdAt);
      return `
        <div class="item">
          <div class="meta">
            <b>${r.status || "Rezerwacja"} • ${r.date} ${r.time}</b>
            <span>${r.people} os. • ${r.name} • ${r.phone}</span>
            <span>${r.notes ? r.notes : ""}</span>
          </div>
          <div class="right">
            <div class="price">${d.toLocaleDateString("pl-PL")}</div>
            <button class="btn small ghost" data-delres="${r.id}">Usuń</button>
          </div>
        </div>
      `;
    }).join("");

    el.querySelectorAll("button[data-delres]").forEach(b => {
      b.addEventListener("click", () => deleteReservation(b.getAttribute("data-delres")));
    });
  }

  function renderAuthUI(){
    const u = getUser();
    const logged = !!u?.email;

    $("#authSub").textContent = logged ? `Zalogowano jako: ${u.email}` : "Zaloguj się, aby korzystać z pełnych funkcji";
    $("#logoutBtn").disabled = !logged;

    const hint = $("#authHint");
    if (hint){
      hint.textContent = logged
        ? `Milk ID: ${getMilkIdForUser()}`
        : "Logowanie jest uproszczone (mock).";
    }

    // top subtitle
    $("#topSubtitle").textContent = logged ? `Zalogowano • ${u.email}` : "Lojalność • Nagrody • Zamówienia";
  }

  /* -------------------------
     Modals
     ------------------------- */
  function openModal(sel){
    const m = $(sel);
    if (!m) return;
    m.classList.add("show");
    m.setAttribute("aria-hidden", "false");
  }
  function closeModal(sel){
    const m = $(sel);
    if (!m) return;
    m.classList.remove("show");
    m.setAttribute("aria-hidden", "true");
  }

  /* -------------------------
     Milk ID modal
     ------------------------- */
  function openMilkId(){
    if (!isLoggedIn()){
      toast.show("Wymagane logowanie", "Zaloguj się, aby zobaczyć Milk ID.");
      showPage("account");
      return;
    }
    const code = getMilkIdForUser();
    $("#milkIdInput").value = code || "••••••";
    $("#milkIdHint").textContent = `Kod jest przypisany do e-maila: ${getUser().email}`;
    openModal("#milkIdModal");
  }

  /* -------------------------
     Install overlay
     ------------------------- */
  let deferredPrompt = null;

  function isStandalone(){
    return window.matchMedia("(display-mode: standalone)").matches || window.navigator.standalone === true;
  }

  function maybeShowInstall(){
    if (isStandalone()) return;
    const shown = store.get("milk_install_dismissed", false);
    if (!shown) openInstall();
  }

  function openInstall(){
    $("#pwaState").textContent = isStandalone() ? "Zainstalowana" : "Przeglądarka";
    openModal("#installOverlay"); // overlay ma klasę .install, ale modal API działa tak samo (ma .show)
    $("#installOverlay").classList.add("show");
  }

  function closeInstall(dismiss){
    $("#installOverlay").classList.remove("show");
    if (dismiss) store.set("milk_install_dismissed", true);
  }

  async function triggerInstall(){
    if (!deferredPrompt){
      toast.show("Instalacja", "Na iOS: Udostępnij → Dodaj do ekranu. Na Android: menu → Zainstaluj.");
      return;
    }
    deferredPrompt.prompt();
    try { await deferredPrompt.userChoice; } catch {}
    deferredPrompt = null;
  }

  /* -------------------------
     Settings subpages
     ------------------------- */
  function showSub(id){
    ["#subPersonal","#subLang","#subAbout","#subHelp"].forEach(s => $(s).classList.add("hide"));
    $(id).classList.remove("hide");
    window.scrollTo({ top: 0, behavior: "smooth" });
  }
  function hideSubs(){
    ["#subPersonal","#subLang","#subAbout","#subHelp"].forEach(s => $(s).classList.add("hide"));
  }

  /* -------------------------
     Which tab is active?
     ------------------------- */
  function showingTab(){
    const btn = $(".nav-btn.active");
    return btn ? btn.getAttribute("data-tab") : "points";
  }

  /* -------------------------
     Service worker
     ------------------------- */
  async function registerSW(){
    if (!("serviceWorker" in navigator)) return;
    try{
      await navigator.serviceWorker.register("sw.js");
    }catch{}
  }

  /* -------------------------
     Bind UI events
     ------------------------- */
  function bind(){
    // bottom nav
    $$(".nav-btn").forEach(b => {
      b.addEventListener("click", () => {
        hideSubs();
        showPage(b.getAttribute("data-tab"));
        renderCartFab();
      });
    });

    // quick actions
    $("#qaMilkId").addEventListener("click", openMilkId);
    $("#qaOrder").addEventListener("click", () => showPage("order"));
    $("#qaRewards").addEventListener("click", () => showPage("rewards"));
    $("#qaReservation").addEventListener("click", () => showPage("reservations"));

    // points page
    $("#openMilkId").addEventListener("click", openMilkId);

    // eatmi
    $("#eatmiBtn").addEventListener("click", () => {
      window.open("https://eatmi.pl", "_blank");
    });

    // status card toggle hours
    let expanded = false;
    renderHours(expanded);
    $("#statusCard").addEventListener("click", () => {
      expanded = !expanded;
      renderHours(expanded);
    });

    // Milk ID modal
    $("#milkIdClose").addEventListener("click", () => closeModal("#milkIdModal"));
    $("#milkIdCopy").addEventListener("click", async () => {
      const v = $("#milkIdInput").value;
      try{ await navigator.clipboard.writeText(v); }catch{}
      toast.show("Skopiowano", "Milk ID skopiowane do schowka.");
    });

    // cart modal open/close
    $("#openCartTop").addEventListener("click", () => { renderCartModal(); openModal("#cartModal"); setDefaultPickupTime(); });
    $("#openCartFab").addEventListener("click", () => { renderCartModal(); openModal("#cartModal"); setDefaultPickupTime(); });
    $("#cartClose").addEventListener("click", () => closeModal("#cartModal"));
    $("#placeOrderBtn").addEventListener("click", placeOrder);

    // install overlay
    $("#installClose").addEventListener("click", () => closeInstall(true));
    $("#installLater").addEventListener("click", () => closeInstall(true));
    $("#installBtn").addEventListener("click", triggerInstall);

    // account login
    $("#loginGoogle").addEventListener("click", () => {
      // mock google: jeśli wpisany email, bierzemy go; jak nie, generujemy
      const email = ($("#emailInput").value || "").trim() || `user${Math.floor(Math.random()*9999)}@gmail.com`;
      setUser({ email, provider: "google", at: nowISO() });
      toast.show("Zalogowano", email);
      renderAuthUI();
    });

    $("#loginEmail").addEventListener("click", () => {
      $("#emailInput").focus();
      toast.show("Logowanie e-mail", "Wpisz e-mail i kliknij “Zaloguj”.");
    });

    $("#loginSubmit").addEventListener("click", async () => {
      const email = ($("#emailInput").value || "").trim();
      const pass = ($("#passInput").value || "").trim();
      if (!email){
        toast.show("Brak e-maila", "Wpisz e-mail.");
        return;
      }

      // próbujemy /api/auth/login (jeśli istnieje)
      let ok = false;
      try{
        const r = await fetch("/api/auth/login", {
          method: "POST",
          headers: { "Content-Type":"application/json" },
          body: JSON.stringify({ email, password: pass })
        });
        ok = r.ok;
      }catch{}

      setUser({ email, provider: "email", at: nowISO(), server: ok });
      toast.show("Zalogowano", ok ? "Zweryfikowano na serwerze." : "Tryb offline (mock).");
      renderAuthUI();
    });

    $("#logoutBtn").addEventListener("click", () => {
      store.del(LS.user);
      toast.show("Wylogowano", "Konto zostało wylogowane.");
      renderAuthUI();
    });

    // settings subpages
    $("#settingsPersonal").addEventListener("click", () => {
      showSub("#subPersonal");
      const prof = store.get(LS.profile, {});
      $("#profName").value = prof.name || "";
      $("#profPhone").value = prof.phone || "";
    });
    $("#settingsLang").addEventListener("click", () => showSub("#subLang"));
    $("#settingsAbout").addEventListener("click", () => showSub("#subAbout"));
    $("#settingsHelp").addEventListener("click", () => showSub("#subHelp"));

    $("#subBack1").addEventListener("click", hideSubs);
    $("#subBack2").addEventListener("click", hideSubs);
    $("#subBack3").addEventListener("click", hideSubs);
    $("#subBack4").addEventListener("click", hideSubs);

    $("#profSave").addEventListener("click", () => {
      const name = ($("#profName").value || "").trim();
      const phone = ($("#profPhone").value || "").trim();
      store.set(LS.profile, { name, phone, at: nowISO() });
      toast.show("Zapisano", "Dane profilu zapisane lokalnie.");
      hideSubs();
    });

    $("#langPL").addEventListener("click", () => {
      store.set(LS.lang, "pl");
      toast.show("Język", "Ustawiono: Polski");
      hideSubs();
    });
    $("#langEN").addEventListener("click", () => {
      store.set(LS.lang, "en");
      toast.show("Language", "Set: English");
      hideSubs();
    });

    // reservations
    $("#resSend").addEventListener("click", sendReservation);

    // toast close (już w toast module)
  }

  /* -------------------------
     Init
     ------------------------- */
  function init(){
    initPointsIfMissing();

    // wersja / pwa state
    $("#appVer").textContent = "1.0";
    $("#pwaState").textContent = isStandalone() ? "Zainstalowana" : "Przeglądarka";

    // status/hours
    renderStatus();
    setInterval(renderStatus, 60_000);

    // render main
    renderAuthUI();
    renderPoints();
    renderRewards();
    renderOrders();
    renderReservations();

    // order tab
    const activeCat = store.get("milk_active_cat", MAIN_CATS[0].id);
    renderOrderCategories(activeCat);
    renderOrderProducts(activeCat);

    // cart
    renderCartFab();
    renderCartModal();

    // subpages hidden
    hideSubs();

    // default tab
    showPage("points");

    // pickup hint initial
    $("#pickupRuleHint").textContent = `Minimalny czas przygotowania: ${pickupLeadMinutes()} min.`;

    // install
    window.addEventListener("beforeinstallprompt", (e) => {
      e.preventDefault();
      deferredPrompt = e;
      // nie pokazujemy na siłę, ale przycisk będzie działał
    });

    // overlay w przeglądarce (bez przesady — można zdjąć jeśli nie chcesz)
    maybeShowInstall();

    // sw
    registerSW();
  }

  // fix: install overlay korzysta z osobnych klas
  function openModalInstallCompat(){
    $("#installOverlay").classList.add("show");
  }

  // “modal” helpers używają .modal, więc dla install robimy oddzielnie (ale i tak operujemy bezpośrednio)
  function openModal(sel){
    const m = $(sel);
    if (!m) return;
    m.classList.add("show");
    m.setAttribute("aria-hidden", "false");
  }

  document.addEventListener("DOMContentLoaded", () => {
    bind();
    init();

    // Drobna poprawka: install overlay (to nie jest .modal)
    // (zostawiamy, bo w init może się pojawić)
    if ($("#installOverlay") && $("#installOverlay").classList.contains("show")) {
      openModalInstallCompat();
    }
  });

})();
</script>

    </script>
  </div>
</body>
</html>
